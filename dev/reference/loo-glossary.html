<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>LOO package glossary — loo-glossary • loo</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LOO package glossary — loo-glossary"><meta name="description" content="The pages provides definitions to key terms. Also see the
FAQ page on
the loo website for answers to frequently asked questions.
Note: VGG2017 refers to Vehtari, Gelman, and Gabry (2017). See
References, below."><meta property="og:description" content="The pages provides definitions to key terms. Also see the
FAQ page on
the loo website for answers to frequently asked questions.
Note: VGG2017 refers to Vehtari, Gelman, and Gabry (2017). See
References, below."><meta property="og:image" content="https://mc-stan.org/loo/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      loo
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/loo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>LOO package glossary</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/loo/blob/reformat-packagedown-workflow/R/loo-glossary.R" class="external-link"><code>R/loo-glossary.R</code></a></small>
      <div class="d-none name"><code>loo-glossary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The pages provides definitions to key terms. Also see the
<a href="https://mc-stan.org/loo/articles/online-only/faq.html">FAQ page</a> on
the <strong>loo</strong> website for answers to frequently asked questions.</p>
<p>Note: VGG2017 refers to Vehtari, Gelman, and Gabry (2017). See
<strong>References</strong>, below.</p>
    </div>


    <div class="section level2">
    <h2 id="elpd-and-elpd-loo">ELPD and <code>elpd_loo</code><a class="anchor" aria-label="anchor" href="#elpd-and-elpd-loo"></a></h2>



<p>The ELPD is the theoretical expected log pointwise predictive density for a new
dataset (Eq 1 in VGG2017), which can be estimated, e.g., using
cross-validation. <code>elpd_loo</code> is the Bayesian LOO estimate of the
expected log pointwise predictive density (Eq 4 in VGG2017) and
is a sum of N individual pointwise log predictive densities. Probability
densities can be smaller or larger than 1, and thus log predictive densities
can be negative or positive. For simplicity the ELPD acronym is used also for
expected log pointwise predictive probabilities for discrete models.
Probabilities are always equal or less than 1, and thus log predictive
probabilities are 0 or negative.</p>
    </div>
    <div class="section level2">
    <h2 id="standard-error-of-elpd-loo">Standard error of <code>elpd_loo</code><a class="anchor" aria-label="anchor" href="#standard-error-of-elpd-loo"></a></h2>



<p>As <code>elpd_loo</code> is defined as the sum of N independent components (Eq 4 in
VGG2017), we can compute the standard error by using the standard deviation
of the N components and multiplying by <code>sqrt(N)</code> (Eq 23 in VGG2017).
This standard error is a coarse description of our uncertainty about the
predictive performance for unknown future data. When N is small or there is
severe model misspecification, the current SE estimate is overoptimistic and
the actual SE can even be twice as large. Even for moderate N, when the SE
estimate is an accurate estimate for the scale, it ignores the skewness. When
making model comparisons, the SE of the component-wise (pairwise) differences
should be used instead (see the <code>se_diff</code> section below and Eq 24 in
VGG2017). Sivula et al. (2022) discuss the conditions when the normal
approximation used for SE and <code>se_diff</code> is good.</p>
    </div>
    <div class="section level2">
    <h2 id="monte-carlo-se-of-elpd-loo">Monte Carlo SE of elpd_loo<a class="anchor" aria-label="anchor" href="#monte-carlo-se-of-elpd-loo"></a></h2>



<p>The Monte Carlo standard error is the estimate for the computational accuracy
of MCMC and importance sampling used to compute <code>elpd_loo</code>. Usually this
is negligible compared to the standard describing the uncertainty due to
finite number of observations (Eq 23 in VGG2017).</p>
    </div>
    <div class="section level2">
    <h2 id="p-loo-effective-number-of-parameters-"><code>p_loo</code> (effective number of parameters)<a class="anchor" aria-label="anchor" href="#p-loo-effective-number-of-parameters-"></a></h2>



<p><code>p_loo</code> is the difference between <code>elpd_loo</code> and the non-cross-validated
log posterior predictive density. It describes how much more difficult it
is to predict future data than the observed data. Asymptotically under
certain regularity conditions, <code>p_loo</code> can be interpreted as the
<em>effective number of parameters</em>. In well behaving cases <code>p_loo &lt; N</code> and
<code>p_loo &lt; p</code>, where <code>p</code> is the total number of parameters in the
model. <code>p_loo &gt; N</code>  or <code>p_loo &gt; p</code> indicates that the model has very
weak predictive capability and may indicate a severe model misspecification.
See below for more on interpreting <code>p_loo</code> when there are warnings
about high Pareto k diagnostic values.</p>
    </div>
    <div class="section level2">
    <h2 id="pareto-k-estimates">Pareto k estimates<a class="anchor" aria-label="anchor" href="#pareto-k-estimates"></a></h2>



<p>The Pareto \(k\) estimate is a diagnostic for Pareto smoothed importance
sampling (PSIS), which is used to compute components of <code>elpd_loo</code>. In
importance-sampling LOO the full posterior distribution is used as the
proposal distribution. The Pareto k diagnostic estimates how far an
individual leave-one-out distribution is from the full distribution. If
leaving out an observation changes the posterior too much then importance
sampling is not able to give a reliable estimate. Pareto smoothing stabilizes
importance sampling and guarantees a finite variance estimate at the
cost of some bias.</p>
<p>The diagnostic threshold for Pareto \(k\) depends on sample size
\(S\) (sample size dependent threshold was introduced by Vehtari
et al., 2024, and before that fixed thresholds of 0.5 and 0.7 were
recommended). For simplicity, <code>loo</code> package uses the nominal sample
size \(S\)  when computing the sample size specific
threshold. This provides an optimistic threshold if the effective
sample size is less than 2200, but even then if ESS/S &gt; 1/2 the difference
is usually negligible. Thinning of MCMC draws can be used to improve
the ratio ESS/S.</p><ul><li><p>If \(k &lt; \min(1 - 1 / \log_{10}(S), 0.7)\), where \(S\) is the
sample size, the PSIS estimate and the corresponding Monte
Carlo standard error estimate are reliable.</p></li>
<li><p>If \(1 - 1 / \log_{10}(S) &lt;= k &lt; 0.7\), the PSIS estimate and the
corresponding Monte Carlo standard error estimate are not
reliable, but increasing the (effective) sample size \(S\) above
2200 may help (this will increase the sample size specific
threshold \((1 - 1 / \log_{10}(2200) &gt; 0.7\) and then the bias specific
threshold 0.7 dominates).</p></li>
<li><p>If \(0.7 &lt;= k &lt; 1\), the PSIS estimate and the corresponding Monte
Carlo standard error have large bias and are not reliable. Increasing
the sample size may reduce the variability in the \(k\) estimate, which
may also result in a lower \(k\) estimate.</p></li>
<li><p>If \(k \geq 1\), the target distribution is estimated to
have non-finite mean. The PSIS estimate and the corresponding Monte
Carlo standard error are not well defined. Increasing the sample size
may reduce the variability in \(k\) estimate, which may also result in
a lower \(k\) estimate.</p></li>
</ul><p>Pareto \(k\) is also useful as a measure of influence of an
observation.  Highly influential observations have high \(k\)
values. Very high \(k\) values often indicate model
misspecification, outliers or mistakes in data processing. See
Section 6 of Gabry et al. (2019) for an example.</p>
<div class="section">
<h3 id="interpreting-p-loo-when-pareto-k-is-large">Interpreting <code>p_loo</code> when Pareto <code>k</code> is large<a class="anchor" aria-label="anchor" href="#interpreting-p-loo-when-pareto-k-is-large"></a></h3>
<p>If \(k &gt; 0.7\) then we can also look at
the <code>p_loo</code> estimate for some additional information about the problem:</p><ul><li><p>If <code>p_loo &lt;&lt; p</code> (the total number of parameters in the model),
then the model is likely to be misspecified. Posterior predictive checks
(PPCs) are then likely to also detect the problem. Try using an overdispersed
model, or add more structural information (nonlinearity, mixture model,
etc.).</p></li>
<li><p>If <code>p_loo &lt; p</code> and the number of parameters <code>p</code> is relatively
large compared to the number of observations (e.g., <code>p&gt;N/5</code>), it is
likely that the model is so flexible or the population prior so weak that it’s
difficult to predict the left out observation (even for the true model).
This happens, for example, in the simulated 8 schools (in VGG2017), random
effect models with a few observations per random effect, and Gaussian
processes and spatial models with short correlation lengths.</p></li>
<li><p>If <code>p_loo &gt; p</code>, then the model is likely to be badly misspecified.
If the number of parameters <code>p&lt;&lt;N</code>, then PPCs are also likely to detect the
problem. See the case study at
<a href="https://avehtari.github.io/modelselection/roaches.html" class="external-link">https://avehtari.github.io/modelselection/roaches.html</a> for an example.
If <code>p</code> is relatively large compared to the number of
observations, say <code>p&gt;N/5</code> (more accurately we should count number of
observations influencing each parameter as in hierarchical models some groups
may have few observations and other groups many), it is possible that PPCs won't
detect the problem.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="elpd-diff">elpd_diff<a class="anchor" aria-label="anchor" href="#elpd-diff"></a></h2>


<p><code>elpd_diff</code> is the difference in <code>elpd_loo</code> for two models. If more
than two models are compared, the difference is computed relative to the
model with highest <code>elpd_loo</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="se-diff">se_diff<a class="anchor" aria-label="anchor" href="#se-diff"></a></h2>



<p>The standard error of component-wise differences of elpd_loo (Eq 24 in
VGG2017) between two models. This SE is <em>smaller</em> than the SE for
individual models due to correlation (i.e., if some observations are easier
and some more difficult to predict for all models).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing</em>. 27(5), 1413–1432. doi:10.1007/s11222-016-9696-4
(<a href="https://link.springer.com/article/10.1007/s11222-016-9696-4" class="external-link">journal version</a>,
<a href="https://arxiv.org/abs/1507.04544" class="external-link">preprint arXiv:1507.04544</a>).</p>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry, J. (2024).
Pareto smoothed importance sampling. <em>Journal of Machine Learning Research</em>,
25(72):1-58.
<a href="https://jmlr.org/papers/v25/19-556.html" class="external-link">PDF</a></p>
<p>Sivula, T, Magnusson, M., Matamoros A. A., and Vehtari, A. (2025).
Uncertainty in Bayesian leave-one-out cross-validation based model
comparison. <em>Bayesian Analysis</em>, accepted for publication.
<a href="https://arxiv.org/abs/2008.10296v5" class="external-link">preprint arXiv:2008.10296v5.</a>.</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
Gelman, A. (2019), Visualization in Bayesian workflow.
<em>J. R. Stat. Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378
(<a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378" class="external-link">journal version</a>,
<a href="https://arxiv.org/abs/1709.01449" class="external-link">preprint arXiv:1709.01449</a>,
<a href="https://github.com/jgabry/bayes-vis-paper" class="external-link">code on GitHub</a>)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aki Vehtari, Jonah Gabry, Måns Magnusson, Yuling Yao, Paul-Christian Bürkner, Topi Paananen, Andrew Gelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

