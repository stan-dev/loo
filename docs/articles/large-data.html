<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Leave-one-out cross-validation for large data • loo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Leave-one-out cross-validation for large data">
<meta property="og:description" content="loo">
<meta property="og:image" content="https://mc-stan.org/loo/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">loo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/loo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="large-data_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Leave-one-out cross-validation for large data</h1>
                        <h4 class="author">Mans Magnusson, Paul Bürkner, Aki Vehtari and Jonah Gabry</h4>
            
            <h4 class="date">2020-12-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/loo/blob/master/vignettes/large-data.Rmd"><code>vignettes/large-data.Rmd</code></a></small>
      <div class="hidden name"><code>large-data.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Using Leave-one-out cross-validation for large data}
-->
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette demonstrates how to do leave-one-out cross-validation for large data using the <strong>loo</strong> package and Stan. There are two approaches covered: LOO with subsampling and LOO using approximations to posterior distributions. Some sections from this vignette are excerpted from the papers</p>
<ul>
<li><p>Magnusson, M., Riis Andersen, M., Jonasson, J. and Vehtari, A. (2020). Leave-One-Out Cross-Validation for Model Comparison in Large Data. Proceedings of the 23rd International Conference on Artificial Intelligence and Statistics (AISTATS), in PMLR 108. <a href="https://arxiv.org/abs/2001.00980">arXiv preprint arXiv:2001.00980</a>.</p></li>
<li><p>Magnusson, M., Andersen, M., Jonasson, J. &amp; Vehtari, A. (2019). Bayesian leave-one-out cross-validation for large data. Proceedings of the 36th International Conference on Machine Learning, in PMLR 97:4244-4253 <a href="http://proceedings.mlr.press/v97/magnusson19a.html">online</a>, <a href="https://arxiv.org/abs/1904.10679">arXiv preprint arXiv:1904.10679</a>.</p></li>
<li><p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. <em>Statistics and Computing</em>. 27(5), 1413–1432. :10.1007/s11222-016-9696-4. Links: <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4">published</a> | <a href="https://arxiv.org/abs/1507.04544">arXiv preprint</a>.</p></li>
<li><p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry, J. (2019). Pareto smoothed importance sampling. <a href="https://arxiv.org/abs/1507.04544">arXiv preprint arXiv:1507.04544</a>.</p></li>
</ul>
<p>which provide important background for understanding the methods implemented in the package.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>In addition to the <strong>loo</strong> package, we’ll also be using <strong>rstan</strong>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"rstan"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"loo"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)</pre></body></html></div>
</div>
<div id="example-well-water-in-bangladesh" class="section level1">
<h1 class="hasAnchor">
<a href="#example-well-water-in-bangladesh" class="anchor"></a>Example: Well water in Bangladesh</h1>
<p>We will use the same example as in the vignette <a href="http://mc-stan.org/loo/articles/loo2-with-rstan.html"><em>Writing Stan programs for use with the loo package</em></a>. See that vignette for a description of the problem and data.</p>
<p>The sample size in this example is only <span class="math inline">\(N=3020\)</span>, which is not large enough to <em>require</em> the special methods for large data described in this vignette, but is sufficient for demonstration purposes in this tutorial.</p>
<div id="coding-the-stan-model" class="section level2">
<h2 class="hasAnchor">
<a href="#coding-the-stan-model" class="anchor"></a>Coding the Stan model</h2>
<p>Here is the Stan code for fitting the logistic regression model, which we save in a file called <code>logistic.stan</code>:</p>
<pre><code>// save in `logistic.stan`
data {
  int&lt;lower=0&gt; N;             // number of data points
  int&lt;lower=0&gt; P;             // number of predictors (including intercept)
  matrix[N,P] X;              // predictors (including 1s for intercept)
  int&lt;lower=0,upper=1&gt; y[N];  // binary outcome
}
parameters {
  vector[P] beta;
}
model {
  beta ~ normal(0, 1);
  y ~ bernoulli_logit(X * beta);
}</code></pre>
<p>Importantly, unlike the general approach recommended in <a href="http://mc-stan.org/loo/articles/loo2-with-rstan.html"><em>Writing Stan programs for use with the loo package</em></a>, we do <em>not</em> compute the log-likelihood for each observation in the <code>generated quantities</code> block of the Stan program. Here we are assuming we have a large data set (larger than the one we’re actually using in this demonstration) and so it is preferable to instead define a function in R to compute the log-likelihood for each data point when needed rather than storing all of the log-likelihood values in memory.</p>
<p>The log-likelihood in R can be coded as follows:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># we'll add an argument log to toggle whether this is a log-likelihood or </span>
<span class="co"># likelihood function. this will be useful later in the vignette.</span>
<span class="no">llfun_logistic</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data_i</span>, <span class="no">draws</span>, <span class="no">log</span> <span class="kw">=</span> <span class="fl">TRUE</span>) {
  <span class="no">x_i</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">data_i</span>[, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">data_i</span>), <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"X"</span>)), <span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>])
  <span class="no">logit_pred</span> <span class="kw">&lt;-</span> <span class="no">draws</span> <span class="kw">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x_i</span>)
  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">data_i</span>$<span class="no">y</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">1</span>/(<span class="fl">1</span> + <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(-<span class="no">logit_pred</span>)), <span class="kw">log</span> <span class="kw">=</span> <span class="no">log</span>)
}</pre></body></html></div>
<p>The function <code>llfun_logistic()</code> needs to have arguments <code>data_i</code> and <code>draws</code>. Below we will test that the function is working by using the <code><a href="../reference/loo.html">loo_i()</a></code> function.</p>
</div>
<div id="fitting-the-model-with-rstan" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-the-model-with-rstan" class="anchor"></a>Fitting the model with RStan</h2>
<p>Next we fit the model in Stan using the <strong>rstan</strong> package:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">url</span> <span class="kw">&lt;-</span> <span class="st">"http://stat.columbia.edu/~gelman/arm/examples/arsenic/wells.dat"</span>
<span class="no">wells</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="no">url</span>)
<span class="no">wells</span>$<span class="no">dist100</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">wells</span>, <span class="no">dist</span> / <span class="fl">100</span>)
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="no">dist100</span> + <span class="no">arsenic</span>, <span class="no">wells</span>)
<span class="no">standata</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">wells</span>$<span class="no">switch</span>, <span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">N</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">X</span>), <span class="kw">P</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">X</span>))

<span class="co"># Compile</span>
<span class="no">stan_mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_model.html">stan_model</a></span>(<span class="st">"logistic.stan"</span>)

<span class="co"># Fit model</span>
<span class="no">fit_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html">sampling</a></span>(<span class="no">stan_mod</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">standata</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">4711</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">fit_1</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"beta"</span>)</pre></body></html></div>
<pre><code>         mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
beta[1]  0.00       0 0.08 -0.15 -0.05  0.00  0.06  0.16  1933    1
beta[2] -0.89       0 0.10 -1.09 -0.96 -0.89 -0.82 -0.69  2332    1
beta[3]  0.46       0 0.04  0.38  0.43  0.46  0.49  0.54  2051    1</code></pre>
<p>Before we move on to computing LOO we can now test that the log-likelihood function we wrote is working as it should. The <code><a href="../reference/loo.html">loo_i()</a></code> function is a helper function that can be used to test a log-likelihood function on a single observation.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># used for draws argument to loo_i</span>
<span class="no">parameter_draws_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html">extract</a></span>(<span class="no">fit_1</span>)$<span class="no">beta</span>

<span class="co"># used for data argument to loo_i</span>
<span class="no">stan_df_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">standata</span>)

<span class="co"># compute relative efficiency (this is slow and optional but is recommended to allow </span>
<span class="co"># for adjusting PSIS effective sample size based on MCMC effective sample size)</span>
<span class="no">r_eff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/relative_eff.html">relative_eff</a></span>(<span class="no">llfun_logistic</span>,
                      <span class="kw">log</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="co"># relative_eff wants likelihood not log-likelihood values</span>
                      <span class="kw">chain_id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">1000</span>),
                      <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
                      <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
                      <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="fu"><a href="../reference/loo.html">loo_i</a></span>(<span class="kw">i</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="no">llfun_logistic</span>, <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>, <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>)</pre></body></html></div>
<pre><code>$pointwise
    elpd_loo mcse_elpd_loo        p_loo     looic influence_pareto_k
1 -0.3314552  0.0002887608 0.0003361772 0.6629103        -0.05679886
...</code></pre>
</div>
</div>
<div id="approximate-loo-cv-using-psis-loo-and-subsampling" class="section level1">
<h1 class="hasAnchor">
<a href="#approximate-loo-cv-using-psis-loo-and-subsampling" class="anchor"></a>Approximate LOO-CV using PSIS-LOO and subsampling</h1>
<p>We can then use the <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> function to compute the efficient PSIS-LOO approximation to exact LOO-CV using subsampling:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ss_1</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
    <span class="no">llfun_logistic</span>,
    <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="co"># take a subsample of size 100</span>
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>,
    <span class="co"># these next objects were computed above</span>
    <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>
  )
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ss_1</span>)</pre></body></html></div>
<pre><code>Computed from 4000 by 100 subsampled log-likelihood
values from 3020 total observations.

         Estimate   SE subsampling SE
elpd_loo  -1968.5 15.6            0.3
p_loo         3.1  0.1            0.4
looic      3936.9 31.2            0.6
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help('pareto-k-diagnostic') for details.</code></pre>
<p>The <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> function creates an object of class <code>psis_loo_ss</code>, that inherits from <code>psis_loo, loo</code> (the classes of regular <code>loo</code> objects).</p>
<p>The printed output above shows the estimates <span class="math inline">\(\widehat{\mbox{elpd}}_{\rm loo}\)</span> (expected log predictive density), <span class="math inline">\(\widehat{p}_{\rm loo}\)</span> (effective number of parameters), and <span class="math inline">\({\rm looic} =-2\, \widehat{\mbox{elpd}}_{\rm loo}\)</span> (the LOO information criterion). Unlike when using <code><a href="../reference/loo.html">loo()</a></code>, when using <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> there is an additional column giving the “subsampling SE”, which reflects the additional uncertainty due to the subsampling used.</p>
<p>The line at the bottom of the printed output provides information about the reliability of the LOO approximation (the interpretation of the <span class="math inline">\(k\)</span> parameter is explained in <code><a href="../reference/pareto-k-diagnostic.html">help('pareto-k-diagnostic')</a></code> and in greater detail in Vehtari, Simpson, Gelman, Yao, and Gabry (2019)). In this case, the message tells us that all of the estimates for <span class="math inline">\(k\)</span> are fine <em>for this given subsample</em>.</p>
<div id="adding-additional-subsamples" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-additional-subsamples" class="anchor"></a>Adding additional subsamples</h2>
<p>If we are not satisfied with the subsample size (i.e., the accuracy) we can simply add more samples until we are satisfied using the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> method.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ss_1b</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(
    <span class="no">loo_ss_1</span>,
    <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="co"># subsample 200 instead of 100</span>
    <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>
  )
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ss_1b</span>)</pre></body></html></div>
<pre><code>Computed from 4000 by 200 subsampled log-likelihood
values from 3020 total observations.

         Estimate   SE subsampling SE
elpd_loo  -1968.3 15.6            0.2
p_loo         3.2  0.1            0.4
looic      3936.7 31.2            0.5
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help('pareto-k-diagnostic') for details.</code></pre>
</div>
<div id="specifying-estimator-and-sampling-method" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-estimator-and-sampling-method" class="anchor"></a>Specifying estimator and sampling method</h2>
<p>The performance relies on two components: the estimation method and the approximation used for the elpd. See the documentation for <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> more information on which estimators and approximations are implemented. The default implementation is using the point log predictive density evaluated at the mean of the posterior (<code>loo_approximation="plpd"</code>) and the difference estimator (<code>estimator="diff_srs"</code>). This combination has a focus on fast inference. But we can easily use other estimators as well as other elpd approximations, for example:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ss_1c</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
    <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
    <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">100</span>,
    <span class="kw">estimator</span> <span class="kw">=</span> <span class="st">"hh_pps"</span>, <span class="co"># use Hansen-Hurwitz</span>
    <span class="kw">loo_approximation</span> <span class="kw">=</span> <span class="st">"lpd"</span>, <span class="co"># use lpd instead of plpd</span>
    <span class="kw">loo_approximation_draws</span> <span class="kw">=</span> <span class="fl">100</span>,
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
  )
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ss_1c</span>)</pre></body></html></div>
<pre><code>Computed from 4000 by 100 subsampled log-likelihood
values from 3020 total observations.

         Estimate   SE subsampling SE
elpd_loo  -1968.9 15.4            0.5
p_loo         3.5  0.2            0.5
looic      3937.9 30.7            1.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help('pareto-k-diagnostic') for details.</code></pre>
<p>See the documentation and references for <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> for details on the implemented approximations.</p>
</div>
</div>
<div id="approximate-loo-cv-using-psis-loo-with-posterior-approximations" class="section level1">
<h1 class="hasAnchor">
<a href="#approximate-loo-cv-using-psis-loo-with-posterior-approximations" class="anchor"></a>Approximate LOO-CV using PSIS-LOO with posterior approximations</h1>
<p>Using posterior approximations, such as variational inference and Laplace approximations, can further speed-up LOO-CV for large data. Here we demonstrate using a Laplace approximation in Stan.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">fit_laplace</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanmodel-method-optimizing.html">optimizing</a></span>(<span class="no">stan_mod</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">standata</span>, <span class="kw">draws</span> <span class="kw">=</span> <span class="fl">2000</span>,
                          <span class="kw">importance_resampling</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">parameter_draws_laplace</span> <span class="kw">&lt;-</span> <span class="no">fit_laplace</span>$<span class="no">theta_tilde</span> <span class="co"># draws from approximate posterior</span>
<span class="no">log_p</span> <span class="kw">&lt;-</span> <span class="no">fit_laplace</span>$<span class="no">log_p</span> <span class="co"># log density of the posterior</span>
<span class="no">log_g</span> <span class="kw">&lt;-</span> <span class="no">fit_laplace</span>$<span class="no">log_g</span> <span class="co"># log density of the approximation</span></pre></body></html></div>
<p>Using the posterior approximation we can then do LOO-CV by correcting for the posterior approximation when we compute the elpd. To do this we use the <code><a href="../reference/loo_approximate_posterior.html">loo_approximate_posterior()</a></code> function.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ap_1</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/loo_approximate_posterior.html">loo_approximate_posterior</a></span>(
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_laplace</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
    <span class="kw">log_p</span> <span class="kw">=</span> <span class="no">log_p</span>,
    <span class="kw">log_g</span> <span class="kw">=</span> <span class="no">log_g</span>,
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
  )
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ap_1</span>)</pre></body></html></div>
<p>The function creates a class, <code>psis_loo_ap</code> that inherits from <code>psis_loo, loo</code>.</p>
<pre><code>Computed from 2000 by 3020 log-likelihood matrix

         Estimate   SE
elpd_loo  -1968.4 15.6
p_loo         3.2  0.2
looic      3936.8 31.2
------
Posterior approximation correction used.
Monte Carlo SE of elpd_loo is 0.0.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     2989  99.0%   1827      
 (0.5, 0.7]   (ok)         31   1.0%   1996      
   (0.7, 1]   (bad)         0   0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)    0   0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.</code></pre>
<div id="combining-the-posterior-approximation-method-with-subsampling" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-the-posterior-approximation-method-with-subsampling" class="anchor"></a>Combining the posterior approximation method with subsampling</h2>
<p>The posterior approximation correction can also be used together with subsampling:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ap_ss_1</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_laplace</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
    <span class="kw">log_p</span> <span class="kw">=</span> <span class="no">log_p</span>,
    <span class="kw">log_g</span> <span class="kw">=</span> <span class="no">log_g</span>,
    <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">100</span>,
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
  )
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ap_ss_1</span>)</pre></body></html></div>
<pre><code>Computed from 2000 by 100 subsampled log-likelihood
values from 3020 total observations.

         Estimate   SE subsampling SE
elpd_loo  -1968.2 15.6            0.4
p_loo         2.9  0.1            0.5
looic      3936.4 31.1            0.8
------
Posterior approximation correction used.
Monte Carlo SE of elpd_loo is 0.0.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     97    97.0%   1971      
 (0.5, 0.7]   (ok)        3     3.0%   1997      
   (0.7, 1]   (bad)       0     0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)  0     0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.</code></pre>
<p>The object created is of class <code>psis_loo_ss</code>, which inherits from the <code>psis_loo_ap</code> class previously described.</p>
</div>
<div id="comparing-models" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-models" class="anchor"></a>Comparing models</h2>
<p>To compare this model to an alternative model for the same data we can use the <code><a href="../reference/loo_compare.html">loo_compare()</a></code> function just as we would if using <code><a href="../reference/loo.html">loo()</a></code> instead of <code><a href="../reference/loo_subsample.html">loo_subsample()</a></code> or <code><a href="../reference/loo_approximate_posterior.html">loo_approximate_posterior()</a></code>. First we’ll fit a second model to the well-switching data, using <code><a href="https://rdrr.io/r/base/Log.html">log(arsenic)</a></code> instead of <code>arsenic</code> as a predictor:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">standata</span>$<span class="no">X</span>[, <span class="st">"arsenic"</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">standata</span>$<span class="no">X</span>[, <span class="st">"arsenic"</span>])
<span class="no">fit_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html">sampling</a></span>(<span class="no">stan_mod</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">standata</span>)
<span class="no">parameter_draws_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html">extract</a></span>(<span class="no">fit_2</span>)$<span class="no">beta</span>
<span class="no">stan_df_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">standata</span>)

<span class="co"># recompute subsampling loo for first model for demonstration purposes</span>

<span class="co"># compute relative efficiency (this is slow and optional but is recommended to allow </span>
<span class="co"># for adjusting PSIS effective sample size based on MCMC effective sample size)</span>
<span class="no">r_eff_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/relative_eff.html">relative_eff</a></span>(
  <span class="no">llfun_logistic</span>,
  <span class="kw">log</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="co"># relative_eff wants likelihood not log-likelihood values</span>
  <span class="kw">chain_id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">1000</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">4711</span>)
<span class="no">loo_ss_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
  <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff_1</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_1</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_1</span>,
  <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">200</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)

<span class="co"># compute subsampling loo for a second model (with log-arsenic)</span>

<span class="no">r_eff_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/relative_eff.html">relative_eff</a></span>(
  <span class="no">llfun_logistic</span>,
  <span class="kw">log</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="co"># relative_eff wants likelihood not log-likelihood values</span>
  <span class="kw">chain_id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">1000</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_2</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_2</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)
<span class="no">loo_ss_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
  <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff_2</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_2</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_2</span>,
  <span class="kw">observations</span> <span class="kw">=</span> <span class="fl">200</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">loo_ss_2</span>)</pre></body></html></div>
<pre><code>Computed from 4000 by 100 subsampled log-likelihood
values from 3020 total observations.

         Estimate   SE subsampling SE
elpd_loo  -1952.0 16.2            0.2
p_loo         2.6  0.1            0.3
looic      3903.9 32.4            0.4
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help('pareto-k-diagnostic') for details.</code></pre>
<p>We can now compare the models on LOO using the <code>loo_compare</code> function:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># Compare</span>
<span class="no">comp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo_compare.html">loo_compare</a></span>(<span class="no">loo_ss_1</span>, <span class="no">loo_ss_2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">comp</span>)</pre></body></html></div>
<pre><code>Warning: Different subsamples in 'model2' and 'model1'. Naive diff SE is used.

       elpd_diff se_diff subsampling_se_diff
model2  0.0       0.0     0.0               
model1 16.5      22.5     0.4               </code></pre>
<p>This new object <code>comp</code> contains the estimated difference of expected leave-one-out prediction errors between the two models, along with the standard error. As the warning indicates, because different subsamples were used the comparison will not take the correlations between different observations into account. Here we see that the naive SE is 22.5 and we cannot see any difference in performance between the models.</p>
<p>To force subsampling to use the same observations for each of the models we can simply extract the observations used in <code>loo_ss_1</code> and use them in <code>loo_ss_2</code> by supplying the <code>loo_ss_1</code> object to the <code>observations</code> argument.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">loo_ss_2</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
    <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff_2</span>,
    <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_2</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_2</span>,
    <span class="kw">observations</span> <span class="kw">=</span> <span class="no">loo_ss_1</span>,
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
  )</pre></body></html></div>
<p>We could also supply the subsampling indices using the <code><a href="../reference/obs_idx.html">obs_idx()</a></code> helper function:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/obs_idx.html">obs_idx</a></span>(<span class="no">loo_ss_1</span>)
<span class="no">loo_ss_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo_subsample.html">loo_subsample</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
  <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff_2</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_2</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_2</span>,
  <span class="kw">observations</span> <span class="kw">=</span> <span class="no">idx</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)</pre></body></html></div>
<pre><code>Simple random sampling with replacement assumed.</code></pre>
<p>This results in a message indicating that we assume these observations to have been sampled with simple random sampling, which is true because we had used the default <code>"diff_srs"</code> estimator for <code>loo_ss_1</code>.</p>
<p>We can now compare the models and estimate the difference based on the same subsampled observations.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">comp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo_compare.html">loo_compare</a></span>(<span class="no">loo_ss_1</span>, <span class="no">loo_ss_2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">comp</span>)</pre></body></html></div>
<pre><code>       elpd_diff se_diff subsampling_se_diff
model2  0.0       0.0     0.0               
model1 16.1       4.4     0.1               </code></pre>
<p>First, notice that now the <code>se_diff</code> is now around 4 (as opposed to 20 when using different subsamples). The first column shows the difference in ELPD relative to the model with the largest ELPD. In this case, the difference in <code>elpd</code> and its scale relative to the approximate standard error of the difference) indicates a preference for the second model (<code>model2</code>). Since the subsampling uncertainty is so small in this case it can effectively be ignored. If we need larger subsamples we can simply add samples using the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> method demonstrated earlier.</p>
<p>It is also possible to compare a subsampled loo computation with a full loo object.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="co"># use loo() instead of loo_subsample() to compute full PSIS-LOO for model 2</span>
<span class="no">loo_full_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/loo.html">loo</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">llfun_logistic</span>,
  <span class="kw">r_eff</span> <span class="kw">=</span> <span class="no">r_eff_2</span>,
  <span class="kw">draws</span> <span class="kw">=</span> <span class="no">parameter_draws_2</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">stan_df_2</span>,
  <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>
)
<span class="fu"><a href="../reference/loo_compare.html">loo_compare</a></span>(<span class="no">loo_ss_1</span>, <span class="no">loo_full_2</span>)</pre></body></html></div>
<pre><code>Estimated elpd_diff using observations included in loo calculations for all models.</code></pre>
<p>Because we are comparing a non-subsampled loo calculation to a subsampled calculation we get the message that only the observations that are included in the loo calculations for both <code>model1</code> and <code>model2</code> are included in the computations for the comparison.</p>
<pre><code>       elpd_diff se_diff subsampling_se_diff
model2  0.0       0.0     0.0               
model1 16.3       4.4     0.3   </code></pre>
<p>Here we actually see an increase in <code>subsampling_se_diff</code>, but this is due to a technical detail not elaborated here. In general, the difference should be better or negligible.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Gelman, A., and Hill, J. (2007). <em>Data Analysis Using Regression and Multilevel Hierarchical Models.</em> Cambridge University Press.</p>
<p>Stan Development Team (2017). <em>The Stan C++ Library, Version 2.17.0.</em> <a href="https://mc-stan.org/" class="uri">https://mc-stan.org/</a></p>
<p>Stan Development Team (2018) <em>RStan: the R interface to Stan, Version 2.17.3.</em> <a href="https://mc-stan.org/" class="uri">https://mc-stan.org/</a></p>
<p>Magnusson, M., Riis Andersen, M., Jonasson, J. and Vehtari, A. (2020). Leave-One-Out Cross-Validation for Model Comparison in Large Data. Proceedings of the 23rd International Conference on Artificial Intelligence and Statistics (AISTATS), in PMLR 108. <a href="https://arxiv.org/abs/2001.00980">arXiv preprint arXiv:2001.00980</a>.</p>
<p>Magnusson, M., Andersen, M., Jonasson, J. &amp; Vehtari, A. (2019). Bayesian leave-one-out cross-validation for large data. Proceedings of the 36th International Conference on Machine Learning, in PMLR 97:4244-4253 <a href="http://proceedings.mlr.press/v97/magnusson19a.html">online</a>, <a href="https://arxiv.org/abs/1904.10679">arXiv preprint arXiv:1904.10679</a>.</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. <em>Statistics and Computing</em>. 27(5), 1413–1432. :10.1007/s11222-016-9696-4. <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4">online</a>, <a href="https://arxiv.org/abs/1507.04544">arXiv preprint arXiv:1507.04544</a>.</p>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry, J. (2019). Pareto smoothed importance sampling. <a href="https://arxiv.org/abs/1507.02646">arXiv preprint arXiv:1507.02646</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aki Vehtari, Jonah Gabry, Mans Magnusson, Yuling Yao, Paul-Christian Bürkner, Topi Paananen, Andrew Gelman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
