<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model comparison — loo_compare • loo</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model comparison — loo_compare"><meta name="description" content="Compare fitted models based on ELPD.
By default the print method shows only the most important information. Use
print(..., simplify=FALSE) to print a more detailed summary."><meta property="og:description" content="Compare fitted models based on ELPD.
By default the print method shows only the most important information. Use
print(..., simplify=FALSE) to print a more detailed summary."><meta property="og:image" content="https://mc-stan.org/loo/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      loo
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/mcmc_stan" aria-label="Visit our Twitter profile"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/loo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Model comparison</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/loo/blob/HEAD/R/loo_compare.R" class="external-link"><code>R/loo_compare.R</code></a>, <a href="https://github.com/stan-dev/loo/blob/HEAD/R/loo_compare.psis_loo_ss_list.R" class="external-link"><code>R/loo_compare.psis_loo_ss_list.R</code></a></small>
      <div class="d-none name"><code>loo_compare.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compare fitted models based on <a href="loo-glossary.html">ELPD</a>.</p>
<p>By default the print method shows only the most important information. Use
<code>print(..., simplify=FALSE)</code> to print a more detailed summary.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">loo_compare</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">loo_compare</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'compare.loo'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, digits <span class="op">=</span> <span class="fl">1</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'compare.loo_ss'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, digits <span class="op">=</span> <span class="fl">1</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>"loo"</code> or a list of such objects. If a list is
used then the list names will be used as the model names in the output. See
<strong>Examples</strong>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional objects of class <code>"loo"</code>, if not passed in as a single
list.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>For the print method only, the number of digits to use when
printing.</p></dd>


<dt id="arg-simplify">simplify<a class="anchor" aria-label="anchor" href="#arg-simplify"></a></dt>
<dd><p>For the print method only, should only the essential columns
of the summary matrix be printed? The entire matrix is always returned, but
by default only the most important columns are printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix with class <code>"compare.loo"</code> that has its own
print method. See the <strong>Details</strong> section.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When comparing two fitted models, we can estimate the difference in their
expected predictive accuracy by the difference in
<code><a href="loo-glossary.html">elpd_loo</a></code> or <code>elpd_waic</code> (or multiplied by \(-2\), if
desired, to be on the deviance scale).</p>
<p>When using <code>loo_compare()</code>, the returned matrix will have one row per model
and several columns of estimates. The values in the
<code><a href="loo-glossary.html">elpd_diff</a></code> and <code><a href="loo-glossary.html">se_diff</a></code> columns of the
returned matrix are computed by making pairwise comparisons between each
model and the model with the largest ELPD (the model in the first row). For
this reason the <code>elpd_diff</code> column will always have the value <code>0</code> in the
first row (i.e., the difference between the preferred model and itself) and
negative values in subsequent rows for the remaining models.</p>
<p>To compute the standard error of the difference in <a href="loo-glossary.html">ELPD</a> —
which should not be expected to equal the difference of the standard errors
— we use a paired estimate to take advantage of the fact that the same
set of \(N\) data points was used to fit both models. These calculations
should be most useful when \(N\) is large, because then non-normality of
the distribution is not such an issue when estimating the uncertainty in
these sums. These standard errors, for all their flaws, should give a
better sense of uncertainty than what is obtained using the current
standard approach of comparing differences of deviances to a Chi-squared
distribution, a practice derived for Gaussian linear models or
asymptotically, and which only applies to nested models in any case.
Sivula et al. (2022) discuss the conditions when the normal
approximation used for SE and <code>se_diff</code> is good.</p>
<p>If more than \(11\) models are compared, we internally recompute the model
differences using the median model by ELPD as the baseline model. We then
estimate whether the differences in predictive performance are potentially
due to chance as described by McLatchie and Vehtari (2023). This will flag
a warning if it is deemed that there is a risk of over-fitting due to the
selection process. In that case users are recommended to avoid model
selection based on LOO-CV, and instead to favor model averaging/stacking or
projection predictive inference.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing</em>. 27(5), 1413–1432. doi:10.1007/s11222-016-9696-4
(<a href="https://link.springer.com/article/10.1007/s11222-016-9696-4" class="external-link">journal version</a>,
<a href="https://arxiv.org/abs/1507.04544" class="external-link">preprint arXiv:1507.04544</a>).</p>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry, J. (2024).
Pareto smoothed importance sampling. <em>Journal of Machine Learning Research</em>,
25(72):1-58.
<a href="https://jmlr.org/papers/v25/19-556.html" class="external-link">PDF</a></p>
<p>Sivula, T, Magnusson, M., Matamoros A. A., and Vehtari, A. (2022).
Uncertainty in Bayesian leave-one-out cross-validation based model
comparison. <a href="https://arxiv.org/abs/2008.10296v3" class="external-link">preprint arXiv:2008.10296v3.</a>.</p>
<p>McLatchie, Y., and Vehtari, A. (2023).  Efficient estimation and
correction of selection-induced bias with order statistics.
<a href="https://arxiv.org/abs/2309.03742" class="external-link">preprint arXiv:2309.03742</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>The <a href="https://mc-stan.org/loo/articles/online-only/faq.html">FAQ page</a> on
the <strong>loo</strong> website for answers to frequently asked questions.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># very artificial example, just for demonstration!</span></span></span>
<span class="r-in"><span><span class="va">LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="example_loglik_array.html">example_loglik_array</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">loo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="loo.html">loo</a></span><span class="op">(</span><span class="va">LL</span><span class="op">)</span>     <span class="co"># should be worst model when compared</span></span></span>
<span class="r-in"><span><span class="va">loo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="loo.html">loo</a></span><span class="op">(</span><span class="va">LL</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># should be second best model when compared</span></span></span>
<span class="r-in"><span><span class="va">loo3</span> <span class="op">&lt;-</span> <span class="fu"><a href="loo.html">loo</a></span><span class="op">(</span><span class="va">LL</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># should be best model when compared</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu">loo_compare</span><span class="op">(</span><span class="va">loo1</span>, <span class="va">loo2</span>, <span class="va">loo3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        elpd_diff se_diff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model3   0.00      0.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model2 -32.00      0.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model1 -64.00      0.00 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show more details with simplify=FALSE</span></span></span>
<span class="r-in"><span><span class="co"># (will be the same for all models in this artificial example)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model3   0.000     0.000 -19.589    4.284       3.329   1.152   39.178   8.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model2 -32.000     0.000 -51.589    4.284       3.329   1.152  103.178   8.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model1 -64.000     0.000 -83.589    4.284       3.329   1.152  167.178   8.568 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can use a list of objects with custom names</span></span></span>
<span class="r-in"><span><span class="co"># will use apple, banana, and cherry, as the names in the output</span></span></span>
<span class="r-in"><span><span class="fu">loo_compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"apple"</span> <span class="op">=</span> <span class="va">loo1</span>, <span class="st">"banana"</span> <span class="op">=</span> <span class="va">loo2</span>, <span class="st">"cherry"</span> <span class="op">=</span> <span class="va">loo3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        elpd_diff se_diff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cherry   0.0       0.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> banana -32.0       0.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> apple  -64.0       0.0  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># works for waic (and kfold) too</span></span></span>
<span class="r-in"><span><span class="fu">loo_compare</span><span class="op">(</span><span class="fu"><a href="waic.html">waic</a></span><span class="op">(</span><span class="va">LL</span><span class="op">)</span>, <span class="fu"><a href="waic.html">waic</a></span><span class="op">(</span><span class="va">LL</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aki Vehtari, Jonah Gabry, Måns Magnusson, Yuling Yao, Paul-Christian Bürkner, Topi Paananen, Andrew Gelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

